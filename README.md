# Splunk to Cribl HEC Converter

This repo is a tool that converts HEC tokens from Splunk into Cribl. I wrote this to work with on-prem instances, feel free to submit a PR for compatibility with cloud instances.

## Splunk HEC CSV Format

You should have a CSV that can be generated by the following search on your HEC instance:

```spl
| rest /services/data/inputs/http
| table title description token source sourcetype index indexes
| eval indexes=mvjoin(indexes, ",")
```

You should be able to then run the conversion tool.

## HEC Conversion Usage

```bash
usage: splunk2criblhec.py [-h] [--input-id INPUT_ID] [--worker-group WORKER_GROUP] csv_path host username password

positional arguments:
  csv_path              path to csv file
  host                  On-prem Cribl host in format 'https://cribl.myhost'
  username              Username to authenticate to Cribl with
  password              Password to authenticate to Cribl with

optional arguments:
  -h, --help            show this help message and exit
  --input-id INPUT_ID   Input ID without the colon prefix, so if your __inputId=='splunk_hec:in_splunk_hec', you would put 'in_splunk_hec'.
                        Defaults to 'in_splunk_hec'.
  --worker-group WORKER_GROUP
                        Worker group name to send to. Deafults to 'default'.
```
